name: On PR Merged - Handle Phase Transitions (DISABLED)

# DISABLED: All PR merge logic has been moved to the Telegram webhook.
# The Telegram webhook is now the single source of truth for PR merge handling.
# See: src/pages/api/telegram-webhook.ts (handleMergeCallback function)
#
# This workflow is kept for reference but disabled via the `if: false` condition.

# Trigger when a PR is closed
on:
  pull_request:
    types: [closed]

jobs:
  on-pr-merged:
    # DISABLED - All logic moved to Telegram webhook
    # To re-enable, change to: if: github.event.pull_request.merged == true
    if: false
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install dependencies
        run: yarn install --frozen-lockfile

      - name: Handle PR merge (phase transitions + status comments)
        env:
          GITHUB_TOKEN: ${{ secrets.PROJECT_TOKEN }}
          GITHUB_OWNER: ${{ vars.PROJECT_OWNER }}
          GITHUB_REPO: ${{ vars.PROJECT_REPO }}
          GITHUB_PROJECT_NUMBER: ${{ vars.PROJECT_NUMBER }}
          GITHUB_OWNER_TYPE: ${{ vars.PROJECT_OWNER_TYPE }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          PR_NUMBER: ${{ github.event.pull_request.number }}
          PR_BODY: ${{ github.event.pull_request.body }}
          PR_TITLE: ${{ github.event.pull_request.title }}
          MERGED_BY: ${{ github.event.pull_request.merged_by.login }}
        run: |
          yarn tsx scripts/template/on-pr-merged.ts
